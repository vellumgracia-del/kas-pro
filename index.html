<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#ffffff">
    <title>Your Manage</title>
    <link rel="manifest" href="manifest.json">
    
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --bg-body: #f8fafc; /* Slate 50 */
            --bg-card: #ffffff;
            --primary: #2563eb; /* Blue 600 */
            --primary-soft: #dbeafe;
            --text-main: #1e293b;
            --text-muted: #94a3b8;
            --shadow-soft: 0 10px 30px -10px rgba(37, 99, 235, 0.2);
            --glass: rgba(255, 255, 255, 0.9);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- 1. ANIMATED LOGO & LANDING --- */
        #landing-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 9999;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            transition: opacity 0.6s ease;
        }

        .logo-svg {
            width: 120px; height: 120px;
            fill: none; stroke: var(--primary);
            stroke-width: 8; stroke-linecap: round; stroke-linejoin: round;
            stroke-dasharray: 1000; stroke-dashoffset: 1000;
            animation: drawLogo 2.5s ease-in-out forwards, floatLogo 3s ease-in-out infinite alternate 2.5s;
            filter: drop-shadow(0 10px 15px rgba(37, 99, 235, 0.3));
        }

        @keyframes drawLogo { to { stroke-dashoffset: 0; fill: rgba(37, 99, 235, 0.1); } }
        @keyframes floatLogo { from { transform: translateY(0); } to { transform: translateY(-10px); } }

        .app-name-splash {
            font-size: 2rem; font-weight: 800;
            background: linear-gradient(135deg, #1e293b 0%, #2563eb 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-top: 20px; opacity: 0;
            animation: fadeInUp 0.8s ease-out 1s forwards;
        }

        .btn-start {
            margin-top: 40px; padding: 15px 50px;
            background: var(--primary); color: white;
            border-radius: 50px; font-weight: 600; border: none;
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
            opacity: 0; animation: fadeInUp 0.8s ease-out 1.5s forwards;
            cursor: pointer; transition: transform 0.2s;
        }
        .btn-start:active { transform: scale(0.95); }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- 2. HEADER & LAYOUT --- */
        #app-container {
            display: none; flex-direction: column;
            height: 100%; max-width: 500px; margin: 0 auto;
            position: relative; width: 100%;
        }

        header {
            padding: 20px 25px; display: flex;
            justify-content: space-between; align-items: center;
            background: transparent;
        }
        
        .header-logo {
            display: flex; align-items: center; gap: 10px;
            font-weight: 800; font-size: 1.2rem; color: var(--primary);
        }

        /* --- 3. MAIN CONTENT --- */
        main {
            flex: 1; overflow-y: auto; padding: 20px;
            padding-bottom: 120px; /* Space for floating nav */
        }

        .card {
            background: var(--bg-card); border-radius: 24px;
            padding: 25px; margin-bottom: 20px;
            box-shadow: var(--shadow-soft); border: 1px solid rgba(255,255,255,0.5);
            transition: transform 0.2s;
        }
        .card:active { transform: scale(0.99); }

        .balance-title { font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .balance-value { font-size: 2.2rem; font-weight: 800; color: var(--text-main); margin: 5px 0 15px 0; }
        
        /* Asset List */
        .asset-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 0; border-bottom: 1px dashed #e2e8f0;
        }
        .asset-row:last-child { border-bottom: none; }
        
        /* --- 4. FLOATING NAVIGATION (The "Exotic" Part) --- */
        .nav-container {
            position: fixed; bottom: 30px; left: 50%;
            transform: translateX(-50%);
            width: 90%; max-width: 400px;
            height: 70px;
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 35px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            display: flex; justify-content: space-evenly; align-items: center;
            border: 1px solid rgba(255,255,255,0.8);
            z-index: 100;
        }

        .nav-item {
            position: relative;
            width: 50px; height: 50px;
            display: flex; justify-content: center; align-items: center;
            border-radius: 50%;
            color: var(--text-muted);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: transparent; border: none; cursor: pointer;
        }

        .nav-item svg { width: 24px; height: 24px; fill: currentColor; }

        .nav-item.active {
            color: white;
            background: var(--primary);
            transform: translateY(-20px); /* Pop up effect */
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.4);
        }

        .nav-item.active::after {
            content: ''; position: absolute; bottom: -15px;
            width: 6px; height: 6px; background: var(--primary);
            border-radius: 50%;
        }

        /* Center FAB inside Nav */
        .nav-fab {
            width: 60px; height: 60px;
            background: linear-gradient(135deg, #1e293b, #0f172a);
            border-radius: 50%;
            color: white; font-size: 2rem;
            display: flex; justify-content: center; align-items: center;
            transform: translateY(-30px); /* High rise */
            box-shadow: 0 10px 25px rgba(30, 41, 59, 0.5);
            border: 4px solid var(--bg-body); /* Cutout effect */
            cursor: pointer;
        }
        .nav-fab:active { transform: translateY(-25px) scale(0.95); }

        /* --- 5. MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.1); backdrop-filter: blur(5px);
            z-index: 200; display: none; opacity: 0;
            transition: opacity 0.3s;
        }
        .modal-card {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: white; border-radius: 30px 30px 0 0;
            padding: 30px; box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .modal-open { display: block; opacity: 1; }
        .modal-open .modal-card { transform: translateY(0); }

        /* Form Elements */
        input, select {
            width: 100%; padding: 15px; margin-bottom: 15px;
            border: 2px solid #f1f5f9; border-radius: 15px;
            font-size: 1rem; background: #f8fafc; outline: none;
            transition: border-color 0.3s;
        }
        input:focus { border-color: var(--primary); background: white; }
        
        .btn-action {
            width: 100%; padding: 16px; border-radius: 15px;
            background: var(--primary); color: white;
            font-weight: 700; border: none; cursor: pointer;
        }
    </style>
</head>
<body>

    <!-- ANIMATED SPLASH SCREEN -->
    <div id="landing-screen">
        <!-- SVG Animated Logo -->
        <svg class="logo-svg" viewBox="0 0 100 100">
            <!-- Outline of a shield/wallet shape -->
            <path d="M50 5 L90 25 V75 L50 95 L10 75 V25 Z" />
            <!-- Inner Chart Line -->
            <path d="M25 65 L40 50 L55 60 L75 35" style="stroke-width: 6;" />
        </svg>
        
        <div class="app-name-splash">Your Manage</div>
        <button class="btn-start" onclick="enterApp()">Mulai Kelola</button>
    </div>

    <!-- MAIN APP -->
    <div id="app-container">
        <header>
            <div class="header-logo">
                <div style="width:10px; height:10px; background:var(--primary); border-radius:50%;"></div>
                Your Manage
            </div>
            <div id="ai-indicator" style="font-size:0.8rem; color: var(--primary); font-weight:600;">AI Active ‚óè</div>
        </header>

        <main>
            <!-- Net Worth Card -->
            <div class="card" style="background: linear-gradient(135deg, #2563eb, #1e40af); color: white; border:none;">
                <div class="balance-title" style="color: rgba(255,255,255,0.7);">Total Kekayaan</div>
                <div class="balance-value" style="color: white;" id="total-balance">Rp 0</div>
                <div style="font-size: 0.9rem; opacity: 0.9;">
                    Cashflow: <span id="cf-status">Stabil</span>
                </div>
            </div>

            <!-- Chart Card -->
            <div class="card">
                <div style="margin-bottom:15px; font-weight:700; color:var(--text-main);">Analisa Pengeluaran</div>
                <div style="position: relative; height: 180px;">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>

            <!-- Asset & AI Section -->
            <div class="card">
                <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                    <span style="font-weight:700;">Aset Non-Likuid</span>
                    <span style="color:var(--primary); font-size:0.8rem;" onclick="triggerAI()">‚ú® AI Valuasi</span>
                </div>
                <div id="asset-list">
                    <p style="text-align:center; color:#cbd5e1; font-size:0.9rem;">Belum ada aset.</p>
                </div>
                <div id="ai-message" style="margin-top:15px; font-size:0.85rem; color: var(--text-muted); font-style: italic; display:none; background:#f1f5f9; padding:10px; border-radius:10px;"></div>
            </div>
        </main>

        <!-- FLOATING EXOTIC NAVIGATION -->
        <div class="nav-container">
            <button class="nav-item active" onclick="switchTab(this, 'home')">
                <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
            </button>
            
            <button class="nav-fab" onclick="openModal()">+</button>
            
            <button class="nav-item" onclick="switchTab(this, 'settings')">
                <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
            </button>
        </div>
    </div>

    <!-- MODAL FORM -->
    <div class="modal-overlay" id="addModal">
        <div class="modal-card">
            <h3 style="margin-bottom:20px;">Tambah Catatan</h3>
            <select id="inputType">
                <option value="income">Pemasukan (+)</option>
                <option value="expense">Pengeluaran (-)</option>
                <option value="asset">Aset (Emas/Tanah)</option>
            </select>
            <input type="text" id="inputDesc" placeholder="Keterangan (cth: Gaji)">
            <input type="number" id="inputValue" placeholder="Nominal (Rp)">
            <button class="btn-action" onclick="saveData()">Simpan</button>
            <button style="width:100%; padding:15px; margin-top:10px; background:transparent; border:none; color:#94a3b8;" onclick="closeModal()">Batal</button>
        </div>
    </div>

    <script>
        // --- DATA STATE ---
        let data = {
            transactions: JSON.parse(localStorage.getItem('ym_trans')) || [],
            assets: JSON.parse(localStorage.getItem('ym_assets')) || []
        };
        let chartInstance = null;

        // --- UI FUNCTIONS ---
        function enterApp() {
            document.getElementById('landing-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('landing-screen').style.display = 'none';
                document.getElementById('app-container').style.display = 'flex';
                updateUI();
            }, 600);
        }

        function formatRp(num) {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(num);
        }

        function updateUI() {
            // Calculate Logic
            let income = data.transactions.filter(t => t.type === 'income').reduce((a,b) => a + b.val, 0);
            let expense = data.transactions.filter(t => t.type === 'expense').reduce((a,b) => a + b.val, 0);
            let assetVal = data.assets.reduce((a,b) => a + b.val, 0);
            
            let total = (income - expense) + assetVal;
            
            // DOM Updates
            document.getElementById('total-balance').innerText = formatRp(total);
            document.getElementById('cf-status').innerText = income > expense ? 'Surplus üìà' : 'Defisit üìâ';

            // Assets List
            const list = document.getElementById('asset-list');
            list.innerHTML = '';
            if(data.assets.length === 0) list.innerHTML = '<p style="text-align:center; color:#cbd5e1; font-size:0.9rem;">Belum ada aset.</p>';
            
            data.assets.forEach(a => {
                list.innerHTML += `
                    <div class="asset-row">
                        <div>
                            <div style="font-weight:600;">${a.desc}</div>
                            <div style="font-size:0.75rem; color:#94a3b8;">Non-Likuid</div>
                        </div>
                        <div style="font-weight:600; color:var(--primary);">${formatRp(a.val)}</div>
                    </div>
                `;
            });

            // Chart
            renderChart(income, expense);
        }

        function renderChart(inc, exp) {
            const ctx = document.getElementById('mainChart');
            if(!ctx || typeof Chart === 'undefined') return;

            if(chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Masuk', 'Keluar'],
                    datasets: [{
                        label: 'Cashflow',
                        data: [inc, exp],
                        backgroundColor: ['#3b82f6', '#ef4444'],
                        borderRadius: 10,
                        barThickness: 30
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { display: false, grid: {display: false} },
                        x: { grid: {display: false} }
                    }
                }
            });
        }

        // --- INTERACTION ---
        function switchTab(btn, tab) {
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            // Logic switch tab content could go here
        }

        function openModal() {
            const m = document.getElementById('addModal');
            m.classList.add('modal-open');
            setTimeout(() => m.style.opacity = '1', 10);
        }

        function closeModal() {
            const m = document.getElementById('addModal');
            m.style.opacity = '0';
            setTimeout(() => m.classList.remove('modal-open'), 300);
        }

        function saveData() {
            const type = document.getElementById('inputType').value;
            const desc = document.getElementById('inputDesc').value;
            const val = parseFloat(document.getElementById('inputValue').value);

            if(!desc || !val) return;

            if(type === 'asset') {
                data.assets.push({id: Date.now(), desc, val});
                localStorage.setItem('ym_assets', JSON.stringify(data.assets));
            } else {
                data.transactions.push({id: Date.now(), type, desc, val});
                localStorage.setItem('ym_trans', JSON.stringify(data.transactions));
            }

            closeModal();
            updateUI();
            
            // Clear
            document.getElementById('inputDesc').value = '';
            document.getElementById('inputValue').value = '';
        }

        function triggerAI() {
            const msg = document.getElementById('ai-message');
            msg.style.display = 'block';
            msg.innerText = "Mengkoneksikan ke server valuasi...";
            
            setTimeout(() => {
                if(!navigator.onLine) {
                    msg.innerText = "‚ö†Ô∏è Offline: Tidak bisa mengambil harga pasar terkini.";
                } else {
                    const totalAsset = data.assets.reduce((a,b)=>a+b.val, 0);
                    if(totalAsset > 100000000) {
                        msg.innerText = "ü§ñ AI Insight: Portofolio Anda kuat. Disarankan diversifikasi ke saham bluechip.";
                    } else {
                        msg.innerText = "ü§ñ AI Insight: Fokus tambah aset emas saat harga koreksi.";
                    }
                }
            }, 1500);
        }

        // --- SERVICE WORKER ---
        if('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js');
        }
    </script>
</body>
</html>
      
